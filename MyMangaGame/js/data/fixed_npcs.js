/**
 * js/data/fixed_npcs.js
 * 固定NPC数据配置文件 - 骨科线深度定制版
 * * 核心机制：沈清舟 (Shen Qingzhou)
 * 1. 【理智值 (Restraint)】: 0-100。
 * - 100-80 (高理智): 克制、冷淡、长兄如父。
 * - 79-30  (动摇期): 阴郁、试探、肢体接触增加。
 * - 29-0   (崩坏期): 强制、疯狂、占有欲爆发。
 * * 2. 【事件触发】: 在 EventSystem 中调用 fixedNPCs.brother.events 中的事件
 */

export const fixedNPCs = {
    brother: {
        // === 基础设定 ===
        id: 'npc_brother_fixed',
        name: '沈清舟',
        relation: 'brother', // 标记为骨科关系
        title: '某大学最年轻的教授 / 沈家现任家主',
        avatar: './assets/avatars/15.jpg', // 设置哥哥的头像为15.jpg
        
        // 外貌特征 (用于生成描述)
        looks: {
            eyes: "镜片后深不见底的瑞凤眼",
            style: "禁欲系，常穿深色高领毛衣或剪裁考究的三件套西装",
            feature: "右眼眼尾有一颗红色的泪痣，平时被金丝眼镜挡住",
            scent: "冷冽的雪松味混合着淡淡的烟草气"
        },

        // === 动态数值 (初始状态) ===
        stats: {
            affection: 65,    // 好感度：血浓于水的基础分
            restraint: 100,   // 理智值：初始满值 (高道德感)
            jealousy: 0,      // 嫉妒值：随着女主和其他男主互动积累
            trust: 50         // 信任度：影响能否触发温情结局
        },

        // === 状态标记 (用于逻辑判断) ===
        flags: {
            met: false,             // 是否已正式重逢
            financial_aid: true,    // 是否接受资助
            secret_discovered: false,// 是否发现女主画他
            route_locked: null      // null, 'happy', 'bad', 'confined'(监禁)
        },

        // ============================================================
        // 1. 日常互动对话池 (根据理智值 restraint 随机抽取)
        // ============================================================
        interactions: {
            // --- 阶段一：高岭之花 (Restraint 80 - 100) ---
            high_sanity: [
                { text: "（推了推眼镜）生活费已经打到你卡上了。别在那种不入流的漫画杂志上浪费太多时间。" },
                { text: "把领口拉好。" },
                { text: "这周末回家吃饭。爸妈那边……我来解决，你只需要露个面。" },
                { text: "（目光扫过你的画稿）画技有进步。" },
                { text: "离那个男的远点，他眼神不正。……我这是作为兄长的建议。" }
            ],

            // --- 阶段二：冰山下的火 (Restraint 30 - 79) ---
            shaken: [
                { text: "……你最近回消息很慢。是在忙，还是在躲我？" },
                { text: "如果不开心就回来。那个房间……我一直让人打扫着，连床单都是你喜欢的颜色。" },
                { text: "（当你提到其他男生时）够了。我并不想听他的事。我是为了你好……真的只是为了你好吗？" },
                { text: "伸手。……指甲太长了，我帮你剪。别动，小时候不都是这样吗？" },
                { text: "（深夜发来的短信）睡了吗？……没事，只是路过你楼下，看你灯还亮着。" },
                { text: "别用这种眼神看我，我会……忍不住。" }
            ],

            // --- 阶段三：彻底崩坏 (Restraint 0 - 29) ---
            broken: [
                { text: "既然无论如何都要下地狱，那不如拖着你一起。" },
                { text: "叫哥哥。……再叫一声。在这个房间里，不需要那种虚伪的道德。" },
                { text: "是你先招惹我的。血缘？正因为有血缘，你这辈子都别想摆脱我。我们生来就是共犯。" },
                { text: "（摘下眼镜，眼神晦暗）那个人碰过你哪里？手？还是嘴唇？……我会把他的痕迹都洗掉。" },
                { text: "逃？你能逃到哪里去？你的户口本、身份证、甚至你的姓氏，都在我手里。" }
            ]
        },

        // ============================================================
        // 2. 核心剧情事件 (Story Events)
        // 包含你要求的四种氛围感剧情
        // ============================================================
        events: {
            
            // --- 场景 A: 资金危机 (触发：金钱 < 100) ---
            financial_crisis: {
                id: 'evt_brother_money',
                triggerType: 'auto',
                title: "来自家里的转账",
                text: "手机震动，银行卡到账 50000 元。\n紧接着是一条简短的信息：\n“别饿着。如果不想要钱，就回来要人。——哥”",
                choices: [
                    {
                        label: "收下钱，回复谢谢",
                        effect: { money: 50000, restraint: -2 }, // 接受馈赠也是一种牵连
                        reply: "（他没有再回复，但你仿佛能看到他对着手机屏幕松了一口气的样子。）"
                    },
                    {
                        label: "原路退回，划清界限",
                        effect: { affection: 10, restraint: -10 }, // 拒绝反而激起控制欲
                        reply: "（三分钟后，他的电话打了过来，声音压抑着怒火：）“你非要和我分得这么清吗？我们流着一样的血，这是你永远改变不了的事实。”"
                    }
                ]
            },

            // --- 场景 B: 生病探视 (触发：精力 < 10) ---
            sick_visit: {
                id: 'evt_brother_sick',
                triggerType: 'auto',
                title: "不速之客",
                text: "你发烧烧得迷迷糊糊，感觉额头上有冰凉的触感。\n睁开眼，沈清舟正坐在床边，西装外套搭在椅背上，袖口挽起，正在给你换毛巾。\n看到你醒来，他动作顿了一下，眼神里的慌乱一闪而过，随即恢复了冷淡。",
                choices: [
                    {
                        label: "虚弱地喊哥哥",
                        effect: { affection: 20, restraint: -5 },
                        reply: "“……我在。”他握住你的手，掌心滚烫，“别怕，只是发烧。小时候你也是这样，一发烧就哭着要哥哥抱。”"
                    },
                    {
                        label: "别过头，不想理他",
                        effect: { restraint: -15, jealousy: 5 },
                        reply: "他捏住你的下巴，强迫你转过头看他：“看着我。生病了还要闹脾气？除了我，现在谁还会管你的死活？”"
                    }
                ]
            },

            // --- 场景 C: 修罗场·雨夜 (你要求的【扭曲的爱】) ---
            // 触发：与其他男主好感度高，且被哥哥撞见
            rainy_confrontation: {
                id: 'evt_brother_rain',
                triggerType: 'conditional',
                title: "死结",
                text: "“你恨我？”\n大雨倾盆，沈清舟把你堵在公寓楼下。他浑身湿透，金丝眼镜上满是水雾，让他看起来狼狈又危险。\n刚刚送你回来的那个男生已经被他用眼神逼退了。\n“那就恨吧。恨比爱长久。如果这是唯一能把你留在我身边的办法，我不介意让你恨我一辈子。”",
                choices: [
                    {
                        label: "狠狠给他一巴掌",
                        effect: { restraint: -30, route: 'dark' }, // 大幅扣除理智，走向黑化
                        reply: "你的手掌发麻，他的脸偏向一边。良久，他转过头，舌尖顶了顶腮帮，竟然笑了一下。\n“打得好。既然动手了，就不准再碰别人。”"
                    },
                    {
                        label: "在大雨中吻他",
                        effect: { restraint: -100, route: 'entangled' }, // 直接清空理智
                        reply: "他愣了一秒，随即反客为主，近乎凶狠地咬住你的唇，带着血腥味和雨水的味道，仿佛要将你拆吃入腹。"
                    }
                ]
            },

            // --- 场景 D: 共生 (你要求的【最亲密的骨科】) ---
            // 触发：理智归零后的特殊早晨
            entangled_fate: {
                id: 'evt_brother_entangled',
                triggerType: 'ending',
                title: "共生",
                text: "醒来时，你发现手腕上多了一条红绳，另一端系在他的手腕上。\n沈清舟坐在床边看书，神色平静得仿佛什么都没发生，只有眼底的青黑暴露了他的疯狂。\n“醒了？”他翻过一页书，“既然你无论如何都学不乖，那从今天起，我们共享呼吸、体温和罪孽。只要我不死，你就永远别想离开。”",
                choices: [
                    {
                        label: "接受命运",
                        effect: { ending: "True Ending: 笼中鸟与共犯" },
                        reply: "你闭上眼，靠进他怀里。这就是你逃离半生，最终却心甘情愿跌落的深渊。"
                    }
                ]
            },

            // --- 场景 E: 破冰 (你要求的【先疏远再亲密】) ---
            // 触发：理智尚存(>30)，但在深夜谈心中选择示弱
            melting_ice: {
                id: 'evt_brother_melting',
                triggerType: 'conditional',
                title: "破冰",
                text: "印象里那个总是冷着脸、只会训斥你的背影，此刻却在你面前颤抖。\n你只是轻轻拽了一下他的衣角，沈清舟一直挺直的脊背就瞬间垮塌。\n他反手将你死死抱进怀里，力道大得像是要将你揉进骨血，声音哽咽。\n“别怕……哥哥在。哥哥一直都在。以前是我太蠢，以为推开你才是保护你……但我做不到，我真的做不到。”",
                choices: [
                    {
                        label: "回抱他",
                        effect: { affection: 50, trust: 20 },
                        reply: "这一刻，横亘在你们之间多年的冰墙，终于在体温中消融。"
                    }
                ]
            },

            // --- 场景 F: 诀别 (你要求的【先亲密再疏远】) ---
            // 触发：理智未崩坏，但外界压力(父母/舆论)过大，选择放手
            farewell_tears: {
                id: 'evt_brother_farewell',
                triggerType: 'ending',
                title: "胶卷",
                text: "他把你小时候画的所有画稿都整理好了，放在箱子里递给你。\n两人手指触碰的瞬间，像触电般同时收回。\n沈清舟没有看你，喉结剧烈滚动，声音沙哑得不成样子：\n“走吧。去画你想画的漫画，去爱……正常的人。别回头。”\n你转身的瞬间，听见身后传来压抑到极致的哽咽声。",
                choices: [
                    {
                        label: "向前走，不回头",
                        effect: { ending: "Normal Ending: 殊途" },
                        reply: "你走进了阳光里，而他永远留在了阴影中。这是你们给彼此最后的爱。"
                    }
                ]
            },
            
            // --- 场景 G: 漫画取材 (特殊行动) ---
            // 触发：玩家主动选择“邀请哥哥做模特”
            art_model: {
                id: 'evt_brother_model',
                triggerType: 'action',
                title: "禁忌的模特",
                text: "你大着胆子提出想画西装暴徒的题材，请求他当模特。\n沈清舟皱着眉解开了领带，又解开了衬衫最上面的两颗扣子。\n“是这样吗？”他坐在沙发上，眼神幽深地盯着正在画画的你，“你的笔触……在抖什么？还是说，你想摸摸看真实的结构？”",
                choices: [
                    {
                        label: "专注画画",
                        effect: { money: 200, restraint: -5 },
                        reply: "你努力无视他灼热的视线，完成了一幅张力十足的速写。"
                    },
                    {
                        label: "上手触碰",
                        effect: { restraint: -20, affection: 10 },
                        reply: "你的指尖划过他的锁骨，感觉到他浑身的肌肉瞬间紧绷。他抓住了你的手腕，呼吸乱了。"
                    }
                ]
            }
        }
    }
};